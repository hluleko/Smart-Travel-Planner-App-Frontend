{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { mapState, mapActions } from 'vuex';\nexport default {\n  name: 'ProfilePage',\n  data() {\n    return {\n      form: {\n        destination: '',\n        budget: '',\n        dietary_restrictions: '',\n        accessibility_needs: '',\n        language_preferences: ''\n      },\n      loading: false,\n      successMessage: '',\n      errorMessage: ''\n    };\n  },\n  computed: {\n    ...mapState(['user'])\n  },\n  watch: {\n    user: {\n      immediate: true,\n      handler(newVal) {\n        if (newVal) {\n          this.initForm();\n        }\n      }\n    }\n  },\n  created() {\n    this.initForm();\n  },\n  methods: {\n    ...mapActions(['updateProfile', 'deleteProfile', 'fetchUser']),\n    initForm(user = this.user) {\n      if (user) {\n        this.form = {\n          destination: user.destination || '',\n          budget: user.budget || '',\n          dietary_restrictions: user.dietary_restrictions || '',\n          accessibility_needs: user.accessibility_needs || '',\n          language_preferences: user.language_preferences || ''\n        };\n      }\n    },\n    async fetchUser() {\n      this.loading = true;\n      try {\n        const user = await this.fetchUser();\n        this.initForm(user); // pass it explicitly to avoid relying on reactivity\n      } catch (err) {\n        console.error('Fetch failed:', err);\n        this.errorMessage = 'Failed to fetch user data.';\n      } finally {\n        this.loading = false;\n      }\n    },\n    async updateProfile() {\n      this.loading = true;\n      this.successMessage = '';\n      this.errorMessage = '';\n      try {\n        await this.updateProfile(this.form);\n        const updatedUser = await this.fetchUser(); // get fresh user\n        this.initForm(updatedUser); // pass it explicitly to avoid relying on reactivity\n        this.successMessage = 'Profile updated successfully!';\n      } catch (err) {\n        console.error('Update failed:', err);\n        this.errorMessage = err.response?.data?.error || 'Failed to update profile.';\n      } finally {\n        this.loading = false;\n      }\n    },\n    async deleteProfile() {\n      if (!confirm('Are you sure you want to delete your profile? This action cannot be undone.')) return;\n      this.loading = true;\n      try {\n        await this.deleteProfile();\n        this.$router.push('/login');\n      } catch (err) {\n        this.errorMessage = 'Failed to delete profile.';\n      } finally {\n        this.loading = false;\n      }\n    }\n  }\n};","map":{"version":3,"names":["mapState","mapActions","name","data","form","destination","budget","dietary_restrictions","accessibility_needs","language_preferences","loading","successMessage","errorMessage","computed","watch","user","immediate","handler","newVal","initForm","created","methods","fetchUser","err","console","error","updateProfile","updatedUser","response","deleteProfile","confirm","$router","push"],"sources":["C:\\Users\\TyreseMakhubele\\Documents\\Other\\P\\SmartTravelApp\\Frontend\\smart-travel-planner\\src\\views\\ProfilePage.vue"],"sourcesContent":["<template>\r\n    <div class=\"profile-container\">\r\n      <h2>User Profile</h2>\r\n  \r\n      <form @submit.prevent=\"updateProfile\" v-if=\"user\">\r\n        <div class=\"form-group\">\r\n          <label>Username:</label>\r\n          <input type=\"text\" :value=\"user.username\" disabled />\r\n        </div>\r\n  \r\n        <div class=\"form-group\">\r\n          <label>Email:</label>\r\n          <input type=\"email\" :value=\"user.email\" disabled />\r\n        </div>\r\n  \r\n        <div class=\"form-group\">\r\n          <label>Destination:</label>\r\n          <input v-model=\"form.destination\" type=\"text\" />\r\n        </div>\r\n  \r\n        <div class=\"form-group\">\r\n          <label>Budget:</label>\r\n          <input v-model=\"form.budget\" type=\"number\" step=\"0.01\" />\r\n        </div>\r\n  \r\n        <div class=\"form-group\">\r\n          <label>Dietary Restrictions:</label>\r\n          <input v-model=\"form.dietary_restrictions\" type=\"text\" />\r\n        </div>\r\n  \r\n        <div class=\"form-group\">\r\n          <label>Accessibility Needs:</label>\r\n          <input v-model=\"form.accessibility_needs\" type=\"text\" />\r\n        </div>\r\n  \r\n        <div class=\"form-group\">\r\n          <label>Language Preferences:</label>\r\n          <input v-model=\"form.language_preferences\" type=\"text\" />\r\n        </div>\r\n  \r\n        <button type=\"submit\" :disabled=\"loading\">\r\n          {{ loading ? 'Updating...' : 'Update Profile' }}\r\n        </button>\r\n  \r\n        <button class=\"delete-btn\" @click.prevent=\"deleteProfile\" :disabled=\"loading\">\r\n          Delete Profile\r\n        </button>\r\n  \r\n        <p class=\"message success\" v-if=\"successMessage\">{{ successMessage }}</p>\r\n        <p class=\"message error\" v-if=\"errorMessage\">{{ errorMessage }}</p>\r\n      </form>\r\n    </div>\r\n  </template>\r\n  \r\n  <script>\r\n  import { mapState, mapActions } from 'vuex';\r\n  \r\n  export default {\r\n    name: 'ProfilePage',\r\n    data() {\r\n      return {\r\n        form: {\r\n          destination: '',\r\n          budget: '',\r\n          dietary_restrictions: '',\r\n          accessibility_needs: '',\r\n          language_preferences: '',\r\n        },\r\n        loading: false,\r\n        successMessage: '',\r\n        errorMessage: '',\r\n      };\r\n    },\r\n    computed: {\r\n      ...mapState(['user']),\r\n    },\r\n    watch: {\r\n        user: {\r\n            immediate: true,\r\n            handler(newVal) {\r\n            if (newVal) {\r\n                this.initForm();\r\n            }\r\n            }\r\n        }\r\n        },\r\n    created() {\r\n      this.initForm();\r\n    },\r\n    methods: {\r\n      ...mapActions(['updateProfile', 'deleteProfile', 'fetchUser']),\r\n      initForm(user = this.user) {\r\n            if (user) {\r\n                this.form = {\r\n                destination: user.destination || '',\r\n                budget: user.budget || '',\r\n                dietary_restrictions: user.dietary_restrictions || '',\r\n                accessibility_needs: user.accessibility_needs || '',\r\n                language_preferences: user.language_preferences || '',\r\n                };\r\n            }\r\n        },\r\n        async fetchUser() {\r\n            this.loading = true;\r\n            try {\r\n                const user = await this.fetchUser();\r\n                this.initForm(user); // pass it explicitly to avoid relying on reactivity\r\n            } catch (err) {\r\n                console.error('Fetch failed:', err);\r\n                this.errorMessage = 'Failed to fetch user data.';\r\n            } finally {\r\n                this.loading = false;\r\n            }\r\n        },\r\n      async updateProfile() {\r\n            this.loading = true;\r\n            this.successMessage = '';\r\n            this.errorMessage = '';\r\n            try {\r\n                await this.updateProfile(this.form);\r\n                const updatedUser = await this.fetchUser(); // get fresh user\r\n                this.initForm(updatedUser); // pass it explicitly to avoid relying on reactivity\r\n                this.successMessage = 'Profile updated successfully!';\r\n            } catch (err) {\r\n                console.error('Update failed:', err);\r\n                this.errorMessage = err.response?.data?.error || 'Failed to update profile.';\r\n            } finally {\r\n                this.loading = false;\r\n            }\r\n        },\r\n      async deleteProfile() {\r\n        if (!confirm('Are you sure you want to delete your profile? This action cannot be undone.')) return;\r\n        this.loading = true;\r\n        try {\r\n          await this.deleteProfile();\r\n          this.$router.push('/login');\r\n        } catch (err) {\r\n          this.errorMessage = 'Failed to delete profile.';\r\n        } finally {\r\n          this.loading = false;\r\n        }\r\n      },\r\n    },\r\n  };\r\n  </script>\r\n  \r\n  <style scoped>\r\n  .profile-container {\r\n    max-width: 500px;\r\n    margin: 2rem auto;\r\n    padding: 2rem;\r\n    border: 1px solid #ddd;\r\n    border-radius: 8px;\r\n    background: #fff;\r\n    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);\r\n  }\r\n  h2 {\r\n    margin-bottom: 1.5rem;\r\n    color: #007bff;\r\n  }\r\n  .form-group {\r\n    margin-bottom: 1rem;\r\n  }\r\n  label {\r\n    display: block;\r\n    font-weight: 600;\r\n    margin-bottom: 0.5rem;\r\n  }\r\n  input {\r\n    width: 100%;\r\n    padding: 0.6rem;\r\n    border-radius: 4px;\r\n    border: 1px solid #ccc;\r\n  }\r\n  button {\r\n    width: 100%;\r\n    padding: 0.8rem;\r\n    background: #007bff;\r\n    border: none;\r\n    color: white;\r\n    font-weight: bold;\r\n    border-radius: 4px;\r\n    margin-top: 1rem;\r\n    cursor: pointer;\r\n  }\r\n  button.delete-btn {\r\n    background: #dc3545;\r\n    margin-top: 0.5rem;\r\n  }\r\n  button:disabled {\r\n    background: #6c757d;\r\n  }\r\n  .message {\r\n    margin-top: 1rem;\r\n    font-weight: bold;\r\n  }\r\n  .success {\r\n    color: green;\r\n  }\r\n  .error {\r\n    color: red;\r\n  }\r\n  </style>\r\n  "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}